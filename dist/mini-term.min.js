/*! mini-term 0.0.1 2014-05-23 */
var History,HistoryItem;HistoryItem=function(){function a(a){this.data=a,this.prev=null,this.next=null}return a}(),History=function(){function a(){this.head=null,this.tail=null,this.current=null}return a.prototype.push=function(a){var b;if(""!==a.trim())return b=new HistoryItem(a),null==this.head?(this.head=b,this.tail=b):(b.prev=this.tail,this.tail.next=b,this.tail=b)},a.prototype.up=function(){return this.current=null==this.current||null==this.current.prev?this.tail:this.current.prev,this.current.data},a.prototype.down=function(){return null==this.current||null==this.current.next?(this.current=null,""):(this.current=this.current.next,this.current.data)},a.prototype.pop=function(){var a;return null==this.current?"":(null==this.current.prev?(this.head=this.current.next,this.head.prev=null):this.current.prev.next=this.current.next,null==this.current.next?(this.tail=this.current.prev,this.tail.next=null):this.current.next.prev=this.current.prev,a=this.current.data,this.current=null,a)},a}(),"undefined"!=typeof module&&null!==module&&(module.exports.History=History);var terminals;(terminals={},function(a){return a.fn.terminal=function(a,b){var c,d,e,f,g;return this.addClass("mini-term"),this.attr("tabindex","1"),this.focus(),f=new Terminal(a,b),c=new History,g=new TerminalVM(this,f,c),terminals[this[0].id]=g,e=function(a){var b;if(a=a||window.event,b=a.target||a.srcElement,b.className.indexOf("mini-term")>-1)8===a.keyCode?(a.preventDefault(),terminals[b.id]._handle_key("BACKSPACE")):13===a.keyCode?(a.preventDefault(),terminals[b.id]._handle_key("ENTER")):38===a.keyCode?(a.preventDefault(),terminals[b.id]._handle_key("UP")):40===a.keyCode&&(a.preventDefault(),terminals[b.id]._handle_key("DOWN"));else if(8===a.keyCode&&!/input|textarea/i.test(b.nodeName))return!1;return!0},d=function(a){var b,c;return a.preventDefault(),a=a||window.event,c=a.target||a.srcElement,c.className.indexOf("mini-term")>-1?(b=String.fromCharCode(a.which||a.charCode||a.keyCode),terminals[c.id]._handle_key(b)):void 0},document.onkeydown=e,document.onkeypress=d,this}})(jQuery);var Terminal;Terminal=function(){function a(a,b){this.interpreter=a,this.set_options(b),this.clear(),this.echo(this._get_option(b,"greeting","welcome to mini-term..."))}return a.prototype.set_lines=function(a){this.lines=a},a.prototype.get_lines=function(){return this.lines},a.prototype.set_buffer=function(a){this.buffer=a},a.prototype.get_buffer=function(){return this.buffer},a.prototype.set_prompt=function(a){this.prompt=a},a.prototype.get_prompt=function(){return"input"===this.mode?this.input_prompt:this.prompt},a.prototype._get_option=function(a,b,c){return null!=a&&null!=a[b]?a[b]:c},a.prototype.set_options=function(a){return this.set_prompt(this._get_option(a,"prompt","mini-term>"))},a.prototype.clear=function(){return this.set_buffer(""),this.set_lines([]),this.mode="buffer"},a.prototype.echo=function(a){return this._echo(a,!1,"",!1)},a.prototype._echo=function(a,b,c,d){var e,f,g,h,i;for(f=a.replace("\r","").split("\n"),i=[],g=0,h=f.length;h>g;g++)e=f[g],i.push(this.lines.push({cmd_ind:b,line:e,prompt:c,masked:d}));return i},a.prototype.accept=function(){var a;return a=this.get_buffer(),this.set_buffer(""),"input"===this.mode?(this._echo(a,!0,this.input_prompt,this.mask_input),this.mode="buffer",this.input_cb(a)):(this._echo(a,!0,this.prompt,!1),this.interpreter(this,a))},a.prototype.get_input=function(a,b){return this.mode="input",this.input_cb=b,this.input_prompt=a,this.mask_input=!1},a.prototype.get_masked_input=function(a,b){return this.mode="input",this.input_cb=b,this.input_prompt=a,this.mask_input=!0},a}(),"undefined"!=typeof module&&null!==module&&(module.exports.Terminal=Terminal);var TerminalVM;TerminalVM=function(){function a(a,b,c){var d;this.element=a,this.terminal=b,this.history=c,this._redraw(),d=this,setInterval(function(){var a;if(d.element.is(":focus"))return a=d.element.find("#cursor"),a.text("_"===a.text()?"":"_")},500),this.element.focusin(function(){var a;return a=d.element.find("#cursor"),a.text("_")}),this.element.focusout(function(){var a;return a=d.element.find("#cursor"),a.text("")})}return a.prototype._handle_key=function(a){switch(a){case"ENTER":this._enter();break;case"BACKSPACE":this.terminal.set_buffer(this.terminal.get_buffer().substring(0,this.terminal.get_buffer().length-1));break;case"UP":this.terminal.set_buffer(this.history.up());break;case"DOWN":this.terminal.set_buffer(this.history.down());break;default:this.terminal.set_buffer(this.terminal.get_buffer()+a)}return this._redraw()},a.prototype._enter=function(){return"input"===this.terminal.mode||this.history.push(this.terminal.get_buffer()),this.terminal.accept()},a.prototype._redraw=function(){var a,b,c,d;for(this.element.empty(),d=this.terminal.get_lines(),b=0,c=d.length;c>b;b++)a=d[b],this.element.append(a.cmd_ind?a.masked?"<div><span id='prompt'>"+a.prompt+"</span></div>":"<div><span id='prompt'>"+a.prompt+"</span>"+a.line+"</div>":"<div>"+a.line+"</div>");return this.element.append("input"===this.terminal.mode&&this.terminal.mask_input?"<div><span id='prompt'>"+this.terminal.get_prompt()+"</span></div>":"<div><span id='prompt'>"+this.terminal.get_prompt()+"</span><span id='buffer'>"+this.terminal.get_buffer()+"</span><span id='cursor'>_</span></div>"),this.element.scrollTop(this.element.prop("scrollHeight"))},a}(),"undefined"!=typeof module&&null!==module&&(module.exports.TerminalVM=TerminalVM);