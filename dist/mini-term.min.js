/*! mini-term 2014-05-19 */
var History,HistoryItem,_;"undefined"!=typeof require&&null!==require&&(_=require("underscore")),HistoryItem=function(){function a(a){this.data=a,this.prev=null,this.next=null}return a}(),History=function(){function a(){this.head=null,this.tail=null,this.current=null}return a.prototype.push=function(a){var b;if(""!==a.trim())return b=new HistoryItem(a),null==this.head?(this.head=b,this.tail=b):(b.prev=this.tail,this.tail.next=b,this.tail=b)},a.prototype.up=function(){return this.current=null==this.current||null==this.current.prev?this.tail:this.current.prev,this.current.data},a.prototype.down=function(){return null==this.current||null==this.current.next?(this.current=null,""):(this.current=this.current.next,this.current.data)},a.prototype.pop=function(){var a;return null==this.current?"":(null==this.current.prev?(this.head=this.current.next,this.head.prev=null):this.current.prev.next=this.current.next,null==this.current.next?(this.tail=this.current.prev,this.tail.next=null):this.current.next.prev=this.current.prev,a=this.current.data,this.current=null,a)},a}(),"undefined"!=typeof module&&null!==module&&(module.exports.History=History);var terminals;(terminals={},function(a){return a.fn.terminal=function(a,b){var c,d,e,f;return this.addClass("mini-term"),this.attr("tabindex","1"),this.focus(),e=new Terminal(a),f=new TerminalVM(this,e,b),terminals[this[0].id]=f,d=function(a){var b;if(a=a||window.event,b=a.target||a.srcElement,"mini-term"===b.className)8===a.keyCode?(a.preventDefault(),terminals[b.id]._handle_key("BACKSPACE")):13===a.keyCode&&(a.preventDefault(),terminals[b.id]._handle_key("ENTER"));else if(8===a.keyCode&&!/input|textarea/i.test(b.nodeName))return!1;return!0},c=function(a){var b,c;return a.preventDefault(),a=a||window.event,c=a.target||a.srcElement,"mini-term"===c.className?(b=String.fromCharCode(a.which||a.charCode||a.keyCode),terminals[c.id]._handle_key(b)):void 0},document.onkeydown=d,document.onkeypress=c,this}})(jQuery);var Terminal,_;"undefined"!=typeof require&&null!==require&&(_=require("underscore")),Terminal=function(){function a(a){this.interpreter=a,this.clear(),this.history=[]}return a.prototype.set_lines=function(a){this.lines=a},a.prototype.get_lines=function(){return this.lines},a.prototype.set_buffer=function(a){this.buffer=a},a.prototype.get_buffer=function(){return this.buffer},a.prototype.set_history=function(a){this.history=a},a.prototype.get_history=function(){return this.history},a.prototype.clear=function(){return this.set_buffer(""),this.set_lines([])},a.prototype.echo=function(a){return this._echo(a,!1)},a.prototype._echo=function(a,b){var c,d,e,f,g;for(d=a.replace("\r","").split("\n"),g=[],e=0,f=d.length;f>e;e++)c=d[e],g.push(this.lines.push({cmd_ind:b,line:c}));return g},a.prototype.accept=function(){var a;return a=this.get_buffer(),this._echo(a,!0),this.set_buffer(""),this.interpreter(this,a)},a}(),"undefined"!=typeof module&&null!==module&&(module.exports.Terminal=Terminal);var TerminalVM,_;"undefined"!=typeof require&&null!==require&&(_=require("underscore")),TerminalVM=function(){function a(a,b,c){var d;this.element=a,this.terminal=b,this.set_options(c),this.terminal.echo(this._get_option(c,"greeting","welcome to mini-term...")),this._redraw(),d=this,setInterval(function(){var a;if(d.element.is(":focus"))return a=d.element.find("#cursor"),a.text("_"===a.text()?"":"_")},500),this.element.focusin(function(){var a;return a=d.element.find("#cursor"),a.text("_")}),this.element.focusout(function(){var a;return a=d.element.find("#cursor"),a.text("")})}return a.prototype._handle_key=function(a){switch(a){case"ENTER":this.terminal.accept();break;case"BACKSPACE":this.terminal.set_buffer(this.terminal.get_buffer().substring(0,this.terminal.get_buffer().length-1));break;default:this.terminal.set_buffer(this.terminal.get_buffer()+a)}return this._redraw()},a.prototype._get_option=function(a,b,c){return null!=a&&null!=a[b]?a[b]:c},a.prototype._redraw=function(){var a,b,c,d;for(this.element.empty(),d=this.terminal.get_lines(),b=0,c=d.length;c>b;b++)a=d[b],this.element.append(a.cmd_ind?"<div><span id='prompt'>"+this.prompt+"</span>"+a.line+"</div>":"<div>"+a.line+"</div>");return this.element.append("<div><span id='prompt'>"+this.prompt+"</span><span id='buffer'>"+this.terminal.get_buffer()+"</span><span id='cursor'>_</span></div>"),this.element.scrollTop(this.element.prop("scrollHeight"))},a.prototype.set_options=function(a){return this.set_prompt(this._get_option(a,"prompt","mini-term>"))},a.prototype.set_greeting=function(a){this.greeting=a},a.prototype.set_prompt=function(a){this.prompt=a},a}(),"undefined"!=typeof module&&null!==module&&(module.exports.TerminalVM=TerminalVM);